#include "exception.hpp"
#include <exception>
#include "streamclient.h"
#include <opencv2/opencv.hpp>
#include "frameserializer.h"
#include "stdio.h"

#define SRV_ADDR "192.168.1.2"
#define SRV_PORT "9999"

int main(int argc, char** argv)
{
    VideoStreamClient vsc("0.0.0.0", "4569");
    vsc.connect(argv[1], argv[2]);//(SRV_ADDR, SRV_PORT);

    while(vsc.isConnected()) {
        cv::Mat sentframe = vsc.requestFrame();
        if(sentframe.empty())
            continue;

        //cv::Mat res(sentframe.rows / SCALE, sentframe.cols / SCALE, CV_8UC3);
        //cv::resize(sentframe, res, cv::Size(0,0), 1/SCALE, 1/SCALE);

        cv::imshow("Sent", sentframe);
        cv::waitKey(1000 / 25);
    }

    vsc.disconnect();
    return 0;
}


